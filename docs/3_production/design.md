ここではDocker使用時にどのようなアプローチでコンテナを設計すればよいかについて紹介します。

## 1コンテナ = 1プロセス
Dockerは1つのプロセスをフォアグラウンドで走らせるための技術です。  
基本的に「1コンテナ = 1プロセス」の粒度で設計しましょう。  

しかし、基本的にほとんどのケースが「1コンテナ = 1プロセス」で設計できますが、全てのケースが一概に1コンテナ = 1プロセスにできるわけじゃないのでその点は見極めましょう。その場合の粒度は「1コンテナにつき1つの関心事」が良いでしょう。

## 永続的なデータはマネージドサービスに任せる
永続的なステータスが必要なコンテナを作成するケースは往々にして存在します。  
データベースのようなデータストアはどこのサービスでも用いいるはずです。  
そういったステータスを持って依存が発生してしまうとDockerの性能に影響を及ぼします。  
Dockerはステートを持たないよう設計しましょう。

## 12factor app
![12factor](imgs/12factor.png)

Heroku社が提唱するモダンなサービスを実現するための12の方法論です。  
コンテナの設計がわからないうちはこの12の方法論にのっとり設計を行うと綺麗な環境を構築することができます。

### 1. コードベース
サービスで動かすコードはgitで管理しましょう。  
サービスとコードは常に1対1であるべきです。

### 2. 依存関係
依存関係は明示的に宣言を行う。  
暗黙的にインストールされるパッケージの存在を許さない。

### 3. 設定
設定を環境変数に格納する。  
アプリケーションの起動には他のサービスへの接続情報・認証情報など復数の設定が環境ごとに必要になる。  
そういった設定をアプリケーションコードから分離し、環境変数で管理する。

### 4. バックエンドサービス
### 5. ビルド・リリース・ラン
### 6. プロセス
### 7. ポートバインディング
### 8. 並行性
### 9. 廃棄容易性
### 10. 開発/本番一致
### 11. ログ
### 12. 管理プロセス
